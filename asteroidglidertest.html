<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.tailwindcss.com https://challenges.cloudflare.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self' data:; connect-src 'self' https://challenges.cloudflare.com; frame-src https://challenges.cloudflare.com; object-src 'none'; base-uri 'self'; form-action 'self'">


<title>Asteroid Glider</title>
<script src="https://cdn.tailwindcss.com"></script>
<!-- Turnstile loader (Invisible mode) -->
<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
<style>
html, body { margin: 0; height: 100%; background: #000; overflow: hidden; }
#gameContainer { width: 100%; max-width: 900px; height: 640px; margin: 0 auto; position: relative; }
canvas { display: block; width: 100% !important; height: 100% !important; border-radius: 0.5rem;
background: radial-gradient(ellipse at center, rgba(0,255,153,0.06) 0%, rgba(0,0,0,1) 60%); }
#uiContainer { position: absolute; inset: 0; pointer-events: none; display: flex; flex-direction: column; justify-content: space-between; }
#overlayTop { display: flex; width: 100%; justify-content: center; gap: 1rem; }
#gameOverModal, #startModal {
position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
background: rgba(0,0,0,0.85); border: 1px solid rgba(16,185,129,0.4);
border-radius: 0.5rem; min-width: 280px; pointer-events: auto;
}
#gameOverModal { display: none; }
.glass { background: rgba(0,0,0,0.35); border: 1px solid rgba(16,185,129,0.15); border-radius: 0.375rem; }
.toast { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display:none; }
#startButton { animation: pulseScale 1.8s ease-in-out infinite; transform-origin: center; will-change: transform; }
#startButton:hover { transform: scale(1.06); }
#startButton:active { transform: scale(0.98); }
@keyframes pulseScale { 0%,100%{transform:scale(1)} 50%{transform:scale(1.06)} }
@media (prefers-reduced-motion: reduce) { #startButton { animation: none !important; } }
</style>
</head>
<body class="bg-black">
<div class="w-screen min-h-screen flex items-center justify-center p-4">
<div id="gameContainer" class="rounded-lg shadow-xl ring-1 ring-green-400/20">
<canvas id="gameCanvas"></canvas>


<div id="uiContainer">
<div id="overlayTop" class="p-2">
<div id="hudStack" class="flex flex-col items-center">
<div id="scoreBoard" class="text-green-400 font-mono p-4 glass">Lvl 1 • Score: 0 • Lasers: 3/5</div>
<div id="rowNotice" class="text-green-400 font-mono opacity-0 transition-opacity duration-300 select-none glass px-3 py-1 rounded"></div>
</div>
</div>


<div id="instructions" class="absolute bottom-16 left-1/2 -translate-x-1/2 pointer-events-none text-green-300 font-mono text-sm opacity-90">
<div class="text-center glass px-3 py-2 rounded">
<div>←/A and →/D to change lanes — Space to shoot — P to pause</div>
<div class="opacity-70">Mobile: swipe to move, tap to shoot</div>
</div>
</div>


<div id="levelToast" class="toast text-green-300 font-mono text-2xl">
<div class="glass px-4 py-2 rounded">Level <span id="toastLevel">1</span></div>
</div>


<div id="startModal" class="text-green-400 font-mono p-4 max-w-md" style="display:block">
<h2 class="text-xl mb-2">Asteroid Glider</h2>
<p class="mb-3 opacity-80 text-sm">Dodge asteroids, shoot threats, and level up.</p>
<button id="startButton" class="pointer-events-auto border border-green-400/50 bg-green-400/5 px-5 py-2 rounded hover:bg-green-400/10 transition font-mono">Start</button>
<div id="startError" class="text-red-400 text-sm mt-2 min-h-[1.25rem]"></div>
</div>


<div id="gameOverModal" class="text-green-400 font-mono p-4 max-w-md">
<h2 class="text-xl mb-2 text-center">Transmission Lost</h2>
<p id="finalScore" class="text-center mb-1">Score: 0</p>
<p id="finalLevel" class="text-center mb-4">Final Level: 1</p>
<div class="flex flex-col sm:flex-row gap-2 items-stretch">
<input id="playerNameInput" placeholder="Your name" maxlength="24" class="flex-1 bg-black/30 border border-green-400/30 rounded px-3 py-2 outline-none" />
<button id="saveScoreButton" class="border border-green-400/50 bg-green-400/5 px-3 py-2 rounded hover:bg-green-400/10 transition">Save Score</button>
</div>
<div class="glass mt-3 p-3 max-h-56 overflow-auto mb-3">
<div class="flex items-center justify-between mb-2">
<h3 class="text-lg">Leaderboard</h3>
<span class="text-xs opacity-70">Top 10 (Global)</span>
</div>
<ol id="leaderboardList" class="space-y-1 text-sm">
<li class="opacity-70">Loading…</li>
</ol>
</div>
<div class="flex justify-center pb-2">
<button id="restartButton" class="pointer-events-auto border border-green-400/50 bg-green-400/5 px-4 py-2 rounded hover:bg-green-400/10 transition font-mono">Restart</button>
</div>
</div>
</div>


<!-- Invisible Turnstile mount (kept outside modals so it always renders) -->
<div id="turnstile-target" style="position:absolute;left:-9999px;top:-9999px;"></div>
</div>
</html>
